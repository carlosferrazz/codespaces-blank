<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Teste Contador</title>
</head>
<body>

<h2>Gerador</h2>

<input id="prompt" placeholder="Digite algo">
<button onclick="generate()">Gerar</button>

<p>Restantes hoje: <span id="remaining"></span></p>
<p id="resultado"></p>

<script>

const MAX_PER_DAY = 2;

function getToday(){
  return new Date().toISOString().split("T")[0];
}

function getData(){
  return JSON.parse(localStorage.getItem("usageTest")) || {
    date: getToday(),
    count: 0
  };
}

function saveData(data){
  localStorage.setItem("usageTest", JSON.stringify(data));
}

function updateUI(data){
  document.getElementById("remaining").innerText =
    MAX_PER_DAY - data.count;
}

function generate(){

  let data = getData();
  const today = getToday();

  if(today !== data.date){
    data.count = 0;
    data.date = today;
  }

  if(data.count >= MAX_PER_DAY){
    alert("Limite atingido!");
    return;
  }

  const prompt = document.getElementById("prompt").value;

  if(!prompt){
    alert("Digite algo");
    return;
  }

  data.count++;
  saveData(data);
  updateUI(data);

  document.getElementById("resultado").innerText =
    "Gerado: " + prompt;
}

window.onload = function(){
  updateUI(getData());
};

</script>

</body>
</html>
