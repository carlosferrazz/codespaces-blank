<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador de Roteiros</title>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XXXXXXXXXX');
</script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#0f172a;
  color:white;
  margin:0;
  padding:20px;
}

button{
  padding:10px 15px;
  border:none;
  background:#06b6d4;
  color:white;
  cursor:pointer;
  border-radius:6px;
}

input{
  padding:10px;
  width:100%;
  margin-bottom:10px;
  border-radius:6px;
  border:none;
}

.section{display:none;}
.active{display:block;}

.card{
  background:#1e293b;
  padding:20px;
  border-radius:10px;
  margin-bottom:20px;
}
</style>
</head>

<body>

<h1>Gerador de Roteiros</h1>

<div class="card">
<input id="prompt" placeholder="Digite o tema do roteiro">
<button onclick="generateScript()">Gerar Roteiro</button>
<p>Restantes hoje: <span id="remaining">2</span></p>
</div>

<div class="card">
<h3>Resultado:</h3>
<p id="resultado"></p>
</div>

<div class="card">
<h3>Estatísticas</h3>
<canvas id="growthChart"></canvas>
</div>

<script>

/* ===== CONTROLE FREE ===== */

const MAX_DAYS = 3;
const MAX_PER_DAY = 2;

function getToday(){
  return new Date().toISOString().split("T")[0];
}

function getUsageData(){
  return JSON.parse(localStorage.getItem("usage")) || {
    startDate: getToday(),
    daysUsed: 0,
    dailyCount: 0,
    lastUseDate: getToday()
  };
}

function saveUsageData(data){
  localStorage.setItem("usage", JSON.stringify(data));
}

function updateUI(data){
  document.getElementById("remaining").innerText =
    MAX_PER_DAY - data.dailyCount;
}

async function generateScript(){

  let data = getUsageData();
  const today = getToday();

  if(today !== data.lastUseDate){
    data.dailyCount = 0;
    data.daysUsed += 1;
    data.lastUseDate = today;
  }

  if(data.daysUsed >= MAX_DAYS){
    alert("Período gratuito encerrado.");
    return;
  }

  if(data.dailyCount >= MAX_PER_DAY){
    alert("Limite diário atingido.");
    return;
  }

  const prompt = document.getElementById("prompt").value;

  if(!prompt){
    alert("Digite um tema.");
    return;
  }

  data.dailyCount += 1;
  saveUsageData(data);
  updateUI(data);

  document.getElementById("resultado").innerText = "Gerando roteiro...";

  // Simulação de API
  setTimeout(()=>{
    document.getElementById("resultado").innerText =
      "Roteiro gerado para: " + prompt;
  },1000);
}

/* ===== GRÁFICO ===== */

const ctx = document.getElementById('growthChart');

new Chart(ctx, {
  type: 'line',
  data: {
    labels: ['Seg','Ter','Qua','Qui','Sex','Sab','Dom'],
    datasets: [{
      label: 'Roteiros Criados',
      data: [1,2,3,4,2,3,5],
      borderColor: '#06b6d4',
      backgroundColor: 'rgba(6,182,212,0.2)',
      tension:0.3
    }]
  },
  options:{
    plugins:{
      legend:{ labels:{ color:'white' }}
    },
    scales:{
      x:{ ticks:{ color:'white'}},
      y:{ ticks:{ color:'white'}}
    }
  }
});

window.onload = function(){
  updateUI(getUsageData());
};

</script>

</body>
</html>
