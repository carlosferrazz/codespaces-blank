<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>NeuroProfit AI - Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      background: #0b1a2e;
      color: white;
      font-family: Arial;
      margin: 0;
    }

    .sidebar {
      width: 200px;
      height: 100vh;
      background: #111f36;
      position: fixed;
      padding: 20px;
    }

    .sidebar h2 {
      font-size: 18px;
      margin-bottom: 30px;
    }

    .sidebar button {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      background: #1e3a5f;
      color: white;
      border: none;
      cursor: pointer;
    }

    .main {
      margin-left: 220px;
      padding: 40px;
    }

    .card {
      background: #162b4d;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>NeuroProfit AI</h2>
  <button onclick="logout()">Logout</button>
</div>

<div class="main">
  <h1>Dashboard</h1>

  <div class="card">
    <h3>Bem-vindo ðŸš€</h3>
    <p>Seu sistema estÃ¡ funcionando.</p>
  </div>

  <div class="card">
    <h3>Status do Plano</h3>
    <p>Plano: Free</p>
    <div style="margin-top:30px; background:#16213e; padding:20px; border-radius:10px;">
  <h3>Gerador de Roteiro IA</h3>

  <textarea 
    id="prompt" 
    placeholder="Digite o tema do vÃ­deo..."
    style="width:100%; height:80px; margin-top:10px; padding:10px; border-radius:6px;">
  </textarea>

  <button 
    onclick="generateScript()" 
    style="margin-top:10px; padding:10px 15px; border:none; border-radius:6px; background:#00bcd4; color:white;">
    Gerar Roteiro
  </button>

  <pre 
    id="resultado" 
    style="margin-top:15px; white-space:pre-wrap;">
  </pre>
    </div>
  </div>

</div>

<script>
const supabaseUrl = "https://fgatcdryezszrojoledj.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZnYXRjZHJ5ZXpzenJvam9sZWRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExNTA2NTEsImV4cCI6MjA4NjcyNjY1MX0.kv9k1EkVYGYUpUcpdGMIF_n3uGFlAxa37nCjx-ZsDaM";

const { createClient } = supabase;
const client = createClient(supabaseUrl, supabaseKey);

// Verifica se estÃ¡ logado
async function checkUser() {
  const { data } = await client.auth.getUser();
  if (!data.user) {
    window.location.href = "/";
  }
}

checkUser();

async function logout() {
  await client.auth.signOut();
  window.location.href = "/";
}
async function generateScript() {
  const prompt = document.getElementById("prompt").value;

  if (!prompt) {
    alert("Digite um tema primeiro.");
    return;
  }

  document.getElementById("resultado").innerText = "Gerando roteiro...";

  const response = await fetch("/api/generate", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ prompt })
  });

  const data = await response.json();
  document.getElementById("resultado").innerText = data.result;
}
</script>

</body>
</html>
